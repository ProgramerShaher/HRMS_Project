-- -- =================================================================================
-- -- المخطط: HR_RECRUITMENT
-- -- الوصف: إدارة التوظيف، الشواغر، والمرشحين
-- -- التبعيات: يعتمد على HR_CORE, HR_PERSONNEL
-- -- =================================================================================

-- -- ALTER SESSION SET CURRENT_SCHEMA = HR_RECRUITMENT;

-- -- 1. الشواغر الوظيفية
-- CREATE TABLE HR_RECRUITMENT.JOB_VACANCIES (
--     VACANCY_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
--     JOB_ID NUMBER(5) NOT NULL,
--     DEPT_ID NUMBER(5) NOT NULL,
--     REQUIRED_COUNT NUMBER(3) DEFAULT 1, -- العدد المطلوب
--     JOB_DESCRIPTION CLOB, -- الوصف الوظيفي التفصيلي
--     REQUIREMENTS CLOB, -- المتطلبات
--     STATUS VARCHAR2(20) DEFAULT 'OPEN' CHECK (STATUS IN ('OPEN', 'CLOSED', 'ON_HOLD', 'CANCELLED')),
--     PUBLISH_DATE DATE,
--     CLOSING_DATE DATE,
    
--     -- Audit Columns
--     CREATED_BY VARCHAR2(50),
--     CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     UPDATED_BY VARCHAR2(50),
--     UPDATED_AT TIMESTAMP,
--     IS_DELETED NUMBER(1) DEFAULT 0,
--     VERSION_NO NUMBER(10) DEFAULT 1,
    
--     CONSTRAINT FK_VAC_JOB FOREIGN KEY (JOB_ID) REFERENCES HR_CORE.JOBS(JOB_ID),
--     CONSTRAINT FK_VAC_DEPT FOREIGN KEY (DEPT_ID) REFERENCES HR_CORE.DEPARTMENTS(DEPT_ID)
-- );

-- -- 2. المرشحين (Talent Pool)
-- CREATE TABLE HR_RECRUITMENT.CANDIDATES (
--     CANDIDATE_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
--     FIRST_NAME_AR VARCHAR2(50),
--     FAMILY_NAME_AR VARCHAR2(50),
--     FULL_NAME_EN VARCHAR2(200) NOT NULL,
--     EMAIL VARCHAR2(100) UNIQUE NOT NULL,
--     PHONE VARCHAR2(20),
--     NATIONALITY_ID NUMBER(3),
--     CV_FILE_PATH VARCHAR2(500),
--     LINKEDIN_PROFILE VARCHAR2(200),
    
--     -- Audit Columns
--     CREATED_BY VARCHAR2(50),
--     CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     UPDATED_BY VARCHAR2(50),
--     UPDATED_AT TIMESTAMP,
--     IS_DELETED NUMBER(1) DEFAULT 0,
--     VERSION_NO NUMBER(10) DEFAULT 1,
    
--     CONSTRAINT FK_CAND_NAT FOREIGN KEY (NATIONALITY_ID) REFERENCES HR_CORE.COUNTRIES(COUNTRY_ID)
-- );

-- -- 3. طلبات التقديم (الربط بين المرشح والشاغر)
-- CREATE TABLE HR_RECRUITMENT.APPLICATIONS (
--     APP_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
--     VACANCY_ID NUMBER(10) NOT NULL,
--     CANDIDATE_ID NUMBER(10) NOT NULL,
--     APPLICATION_DATE DATE DEFAULT SYSDATE,
--     STATUS VARCHAR2(20) DEFAULT 'APPLIED' CHECK (STATUS IN ('APPLIED', 'SCREENING', 'SHORTLISTED', 'INTERVIEW', 'OFFERED', 'HIRED', 'REJECTED')),
--     REJECTION_REASON VARCHAR2(200),
--     RX_SOURCE VARCHAR2(50), -- مصدر التوظيف (LinkedIn, Portal, Referral)
    
--     -- Audit Columns
--     CREATED_BY VARCHAR2(50),
--     CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     UPDATED_BY VARCHAR2(50),
--     UPDATED_AT TIMESTAMP,
--     IS_DELETED NUMBER(1) DEFAULT 0,
--     VERSION_NO NUMBER(10) DEFAULT 1,
    
--     CONSTRAINT FK_APP_VAC FOREIGN KEY (VACANCY_ID) REFERENCES HR_RECRUITMENT.JOB_VACANCIES(VACANCY_ID),
--     CONSTRAINT FK_APP_CAND FOREIGN KEY (CANDIDATE_ID) REFERENCES HR_RECRUITMENT.CANDIDATES(CANDIDATE_ID)
-- );

-- -- 4. المقابلات
-- CREATE TABLE HR_RECRUITMENT.INTERVIEWS (
--     INTERVIEW_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
--     APP_ID NUMBER(10) NOT NULL,
--     INTERVIEWER_ID NUMBER(10), -- الموظف الذي يجري المقابلة
--     SCHEDULED_TIME TIMESTAMP NOT NULL,
--     INTERVIEW_TYPE VARCHAR2(20) DEFAULT 'IN_PERSON' CHECK (INTERVIEW_TYPE IN ('PHONE', 'ONLINE', 'IN_PERSON')),
--     RATING NUMBER(1), -- 1 to 5
--     FEEDBACK CLOB,
--     RESULT VARCHAR2(20) CHECK (RESULT IN ('PASS', 'FAIL', 'PENDING')),
    
--     -- Audit Columns
--     CREATED_BY VARCHAR2(50),
--     CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     UPDATED_BY VARCHAR2(50),
--     UPDATED_AT TIMESTAMP,
--     IS_DELETED NUMBER(1) DEFAULT 0,
--     VERSION_NO NUMBER(10) DEFAULT 1,
    
--     CONSTRAINT FK_INT_APP FOREIGN KEY (APP_ID) REFERENCES HR_RECRUITMENT.APPLICATIONS(APP_ID),
--     CONSTRAINT FK_INT_EMP FOREIGN KEY (INTERVIEWER_ID) REFERENCES HR_PERSONNEL.EMPLOYEES(EMPLOYEE_ID)
-- );

-- -- 5. عروض العمل
-- CREATE TABLE HR_RECRUITMENT.OFFERS (
--     OFFER_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
--     APP_ID NUMBER(10) NOT NULL,
--     OFFER_DATE DATE DEFAULT SYSDATE,
--     BASIC_SALARY NUMBER(10, 2),
--     HOUSING_ALLOWANCE NUMBER(10, 2),
--     TRANSPORT_ALLOWANCE NUMBER(10, 2),
--     JOINING_DATE DATE,
--     STATUS VARCHAR2(20) DEFAULT 'DRAFT' CHECK (STATUS IN ('DRAFT', 'SENT', 'ACCEPTED', 'DECLINED')),
    
--     -- Audit Columns
--     CREATED_BY VARCHAR2(50),
--     CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
--     UPDATED_BY VARCHAR2(50),
--     UPDATED_AT TIMESTAMP,
--     IS_DELETED NUMBER(1) DEFAULT 0,
--     VERSION_NO NUMBER(10) DEFAULT 1,
    
--     CONSTRAINT FK_OFFER_APP FOREIGN KEY (APP_ID) REFERENCES HR_RECRUITMENT.APPLICATIONS(APP_ID)
-- );

-- -- ملاحظة: الصلاحيات سيتم منحها في ملف منفصل
