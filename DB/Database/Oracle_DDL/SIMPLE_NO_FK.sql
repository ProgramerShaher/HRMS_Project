-- =================================================================================
-- سكربت نهائي بسيط - بدون Foreign Keys (للاختبار)
-- =================================================================================

ALTER SESSION SET CONTAINER = XEPDB1;

-- ============ HR_CORE ============
CREATE TABLE HR_CORE.COUNTRIES (
    COUNTRY_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    COUNTRY_NAME_AR VARCHAR2(100) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE HR_CORE.DEPARTMENTS (
    DEPT_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DEPT_NAME_AR VARCHAR2(100) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE HR_CORE.JOBS (
    JOB_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    JOB_TITLE_AR VARCHAR2(100) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============ HR_PERSONNEL ============
CREATE TABLE HR_PERSONNEL.EMPLOYEES (
    EMPLOYEE_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    EMPLOYEE_NUMBER VARCHAR2(20) NOT NULL UNIQUE,
    FULL_NAME_AR VARCHAR2(200) NOT NULL,
    NATIONALITY_ID NUMBER(3),  -- بدون FK مؤقتاً
    JOB_ID NUMBER(5),          -- بدون FK مؤقتاً
    DEPT_ID NUMBER(5),         -- بدون FK مؤقتاً
    JOINING_DATE DATE,
    STATUS VARCHAR2(20) DEFAULT 'ACTIVE',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============ HR_ATTENDANCE ============
CREATE TABLE HR_ATTENDANCE.DAILY_ATTENDANCE (
    RECORD_ID NUMBER(15) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    EMPLOYEE_ID NUMBER(10) NOT NULL,
    ATTENDANCE_DATE DATE NOT NULL,
    STATUS VARCHAR2(20),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============ HR_LEAVES ============
CREATE TABLE HR_LEAVES.LEAVE_REQUESTS (
    REQUEST_ID NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    EMPLOYEE_ID NUMBER(10) NOT NULL,
    START_DATE DATE NOT NULL,
    END_DATE DATE NOT NULL,
    STATUS VARCHAR2(20) DEFAULT 'PENDING',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============ HR_PAYROLL ============
CREATE TABLE HR_PAYROLL.PAYSLIPS (
    PAYSLIP_ID NUMBER(15) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    EMPLOYEE_ID NUMBER(10) NOT NULL,
    MONTH NUMBER(2),
    YEAR NUMBER(4),
    NET_SALARY NUMBER(10, 2),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

SELECT 'تم إنشاء 7 جداول بنجاح (بدون Foreign Keys)!' AS STATUS FROM DUAL;

-- التحقق
SELECT owner, table_name 
FROM all_tables 
WHERE owner IN ('HR_CORE', 'HR_PERSONNEL', 'HR_ATTENDANCE', 'HR_LEAVES', 'HR_PAYROLL')
ORDER BY owner, table_name;
