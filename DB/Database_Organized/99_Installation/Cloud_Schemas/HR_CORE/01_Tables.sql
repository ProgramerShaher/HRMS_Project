-- =================================================================================
-- HR_CORE - الجداول الأساسية
-- =================================================================================
-- Schema: HR_CORE
-- الملف: 01_Tables.sql
-- المحتوى: 9 جداول + Foreign Keys
-- =================================================================================

SET DEFINE OFF;
SET SERVEROUTPUT ON;

PROMPT ========================================
PROMPT HR_CORE - إنشاء الجداول
PROMPT ========================================

-- 1. جدول الدول
CREATE TABLE COUNTRIES (
    COUNTRY_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    COUNTRY_NAME_AR VARCHAR2(100) NOT NULL,
    COUNTRY_NAME_EN VARCHAR2(100) NOT NULL,
    CITIZENSHIP_NAME_AR VARCHAR2(100),
    ISO_CODE CHAR(2) UNIQUE,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 2. جدول المدن
CREATE TABLE CITIES (
    CITY_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    COUNTRY_ID NUMBER(3) NOT NULL,
    CITY_NAME_AR VARCHAR2(100) NOT NULL,
    CITY_NAME_EN VARCHAR2(100) NOT NULL,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 3. جدول الفروع
CREATE TABLE BRANCHES (
    BRANCH_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    BRANCH_NAME_AR VARCHAR2(100) NOT NULL,
    BRANCH_NAME_EN VARCHAR2(100),
    CITY_ID NUMBER(5),
    ADDRESS VARCHAR2(200),
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 4. جدول الأقسام
CREATE TABLE DEPARTMENTS (
    DEPT_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DEPT_NAME_AR VARCHAR2(100) NOT NULL,
    DEPT_NAME_EN VARCHAR2(100),
    PARENT_DEPT_ID NUMBER(5),
    BRANCH_ID NUMBER(3) NOT NULL,
    COST_CENTER_CODE VARCHAR2(50),
    MANAGER_ID NUMBER,
    IS_ACTIVE NUMBER(1) DEFAULT 1,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 5. جدول الدرجات الوظيفية
CREATE TABLE JOB_GRADES (
    GRADE_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    GRADE_NAME VARCHAR2(50) NOT NULL,
    MIN_SALARY NUMBER(10, 2),
    MAX_SALARY NUMBER(10, 2),
    TICKET_CLASS VARCHAR2(20),
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 6. جدول الوظائف
CREATE TABLE JOBS (
    JOB_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    JOB_TITLE_AR VARCHAR2(100) NOT NULL,
    JOB_TITLE_EN VARCHAR2(100),
    DEFAULT_GRADE_ID NUMBER(3),
    IS_MEDICAL NUMBER(1) DEFAULT 0,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 7. جدول أنواع الوثائق
CREATE TABLE DOCUMENT_TYPES (
    DOC_TYPE_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DOC_NAME_AR VARCHAR2(100) NOT NULL,
    IS_MANDATORY NUMBER(1) DEFAULT 0,
    REQUIRES_EXPIRY NUMBER(1) DEFAULT 1,
    ALERT_DAYS_BEFORE NUMBER(3) DEFAULT 30,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 8. جدول البنوك
CREATE TABLE BANKS (
    BANK_ID NUMBER(3) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    BANK_NAME_AR VARCHAR2(100) NOT NULL,
    BANK_NAME_EN VARCHAR2(100),
    BANK_CODE VARCHAR2(20),
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

-- 9. جدول إعدادات النظام
CREATE TABLE SYSTEM_SETTINGS (
    SETTING_ID NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    SETTING_KEY VARCHAR2(100) NOT NULL UNIQUE,
    SETTING_VALUE VARCHAR2(500),
    SETTING_TYPE VARCHAR2(20) CHECK (SETTING_TYPE IN ('STRING', 'NUMBER', 'DATE', 'BOOLEAN')),
    DESCRIPTION_AR VARCHAR2(200),
    IS_EDITABLE NUMBER(1) DEFAULT 1,
    CREATED_BY VARCHAR2(50), 
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_BY VARCHAR2(50), 
    UPDATED_AT TIMESTAMP,
    IS_DELETED NUMBER(1) DEFAULT 0, 
    VERSION_NO NUMBER(10) DEFAULT 1
);

PROMPT ✅ تم إنشاء 9 جداول

-- إضافة Foreign Keys
ALTER TABLE CITIES ADD CONSTRAINT FK_CITIES_COUNTRY 
    FOREIGN KEY (COUNTRY_ID) REFERENCES COUNTRIES(COUNTRY_ID);

ALTER TABLE BRANCHES ADD CONSTRAINT FK_BRANCHES_CITY 
    FOREIGN KEY (CITY_ID) REFERENCES CITIES(CITY_ID);

ALTER TABLE DEPARTMENTS ADD CONSTRAINT FK_DEPT_BRANCH 
    FOREIGN KEY (BRANCH_ID) REFERENCES BRANCHES(BRANCH_ID);

ALTER TABLE DEPARTMENTS ADD CONSTRAINT FK_DEPT_PARENT 
    FOREIGN KEY (PARENT_DEPT_ID) REFERENCES DEPARTMENTS(DEPT_ID);

ALTER TABLE JOBS ADD CONSTRAINT FK_JOBS_GRADE 
    FOREIGN KEY (DEFAULT_GRADE_ID) REFERENCES JOB_GRADES(GRADE_ID);

PROMPT ✅ تم إضافة Foreign Keys

PROMPT ========================================
PROMPT ✅ اكتمل إنشاء جداول HR_CORE
PROMPT ========================================
