<div class="space-y-8 animate-in fade-in slide-in-from-bottom-5 duration-700">

  <!-- Clean Header Section -->
  <div
    class="bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-200 dark:border-slate-800 shadow-sm flex flex-col md:flex-row justify-between items-center gap-6">
    <div class="flex items-center gap-5">
      <div
        class="w-12 h-12 rounded-xl bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center text-blue-600 dark:text-blue-400">
        <i class="pi pi-graduation-cap text-2xl"></i>
      </div>
      <div>
        <h2 class="text-xl font-bold text-slate-800 dark:text-white leading-tight">السجل الأكاديمي والمهني</h2>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1 font-medium">
          توثيق المسار العلمي والخبرات العملية والشهادات الدولية
        </p>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <span
        class="px-3 py-1.5 bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-bold rounded-lg border border-slate-100 dark:border-slate-700">
        Professional Portfolio
      </span>
    </div>
  </div>

  <div class="grid grid-cols-1 xl:grid-cols-2 gap-8 items-start">
    <!-- Qualifications Section -->
    <section>
      <app-dynamic-array-list [items]="data.qualifications || []" title="المؤهلات العلمية" itemLabel="مؤهل"
        icon="pi pi-book" [columns]="qualColumns" (save)="onSaveQualification($event)"
        (delete)="onDeleteQualification($event)">

        <ng-template #formTemplate let-item>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-5 p-1">
            <div class="space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">الدرجة العلمية <span
                  class="text-red-500">*</span></label>
              <input pInputText [(ngModel)]="item.degreeType" placeholder="بكالوريوس، ماجستير..."
                class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
            </div>
            <div class="space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">التخصص الدراسي <span
                  class="text-red-500">*</span></label>
              <input pInputText [(ngModel)]="item.majorAr" placeholder="نظم معلومات، محاسبة..."
                class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
            </div>
            <div class="space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">المؤسسة التعليمية</label>
              <input pInputText [(ngModel)]="item.universityAr" placeholder="اسم الجامعة أو المعهد"
                class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
            </div>
            <div class="space-y-2">
              <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 font-sans">Graduation
                Year</label>
              <p-inputNumber [(ngModel)]="item.graduationYear" [useGrouping]="false" placeholder="YYYY"
                styleClass="w-full"
                inputStyleClass="!h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm !font-bold focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all"></p-inputNumber>
            </div>

            <!-- File Upload for Qual -->
            <div class="md:col-span-2 pt-2">
              <div
                class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 hover:border-blue-400 transition-colors">
                <div class="flex items-center gap-3">
                  <div
                    class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400">
                    <i class="pi pi-file text-sm"></i>
                  </div>
                  <div>
                    <p class="text-xs font-semibold text-slate-700 dark:text-slate-200">صورة المؤهل</p>
                    <p class="text-[10px] text-slate-500">{{ item.file ? item.file.name : 'لم يتم اختيار ملف' }}</p>
                  </div>
                </div>
                <p-fileUpload mode="basic" [auto]="true" chooseLabel="تصفح"
                  styleClass="p-button-outlined p-button-sm !rounded-lg !text-xs !px-3 !h-8"
                  (onSelect)="onQualFileSelect($event, item)"></p-fileUpload>
              </div>
            </div>
          </div>
        </ng-template>
      </app-dynamic-array-list>
    </section>

    <!-- Experience Section -->
    <section>
      <app-dynamic-array-list [items]="data.experiences || []" title="الخبرات العملية" itemLabel="خبرة"
        icon="pi pi-briefcase" [columns]="expColumns" (save)="onSaveExperience($event)"
        (delete)="onDeleteExperience($event)">

        <ng-template #formTemplate let-item>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-5 p-1">
            <div class="md:col-span-2 space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">المسمى الوظيفي <span
                  class="text-red-500">*</span></label>
              <input pInputText [(ngModel)]="item.jobTitleAr" placeholder="مثال: مدير تسويق"
                class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
            </div>
            <div class="md:col-span-2 space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">جهة العمل <span
                  class="text-red-500">*</span></label>
              <input pInputText [(ngModel)]="item.companyNameAr" placeholder="اسم الشركة"
                class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
            </div>
            <div class="space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">من تاريخ</label>
              <p-datePicker [(ngModel)]="item.startDate" [showIcon]="true" appendTo="body" dateFormat="yy-mm-dd"
                styleClass="w-full"
                inputStyleClass="!h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all"></p-datePicker>
            </div>
            <div class="space-y-2">
              <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">إلى تاريخ</label>
              <p-datePicker [(ngModel)]="item.endDate" [showIcon]="true" appendTo="body" dateFormat="yy-mm-dd"
                styleClass="w-full"
                inputStyleClass="!h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all"></p-datePicker>
            </div>

            <!-- Current Job Toggle -->
            <div class="md:col-span-2 pt-2">
              <div class="flex items-center gap-3">
                <p-checkbox [(ngModel)]="item.isCurrent" binary="true" inputId="isCurrentJob"></p-checkbox>
                <label for="isCurrentJob"
                  class="text-sm text-slate-700 dark:text-slate-300 cursor-pointer user-select-none">لا أزال أعمل هنا
                  حالياً</label>
              </div>
            </div>
          </div>
        </ng-template>
      </app-dynamic-array-list>
    </section>

    <!-- Professional Certifications (Full Width) -->
    <section class="xl:col-span-2">
      <app-dynamic-array-list [items]="data.certifications || []" title="الشهادات المهنية والدورات" itemLabel="شهادة"
        icon="pi pi-verified" [columns]="certColumns" (save)="onSaveCertification($event)"
        (delete)="onDeleteCertification($event)">

        <ng-template #formTemplate let-item>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-2">
            <!-- Left: Basic Info -->
            <div class="space-y-5">
              <div class="space-y-2">
                <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">اسم الشهادة / الدورة <span
                    class="text-red-500">*</span></label>
                <input pInputText [(ngModel)]="item.certificationName" placeholder="PMP, CCNA..."
                  class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm font-bold focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
              </div>

              <div class="space-y-2">
                <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">جهة الإصدار</label>
                <input pInputText [(ngModel)]="item.issuingOrganization" placeholder="PMI, Microsoft..."
                  class="w-full !h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all" />
              </div>

              <div class="space-y-2">
                <label class="block text-xs font-semibold text-slate-700 dark:text-slate-300">تاريخ الإصدار</label>
                <p-datePicker [(ngModel)]="item.issueDate" [showIcon]="true" appendTo="body" dateFormat="yy-mm-dd"
                  styleClass="w-full"
                  inputStyleClass="!h-11 !rounded-lg !bg-white dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500 transition-all"></p-datePicker>
              </div>
            </div>

            <!-- Right: Verification & Upload -->
            <div class="space-y-5">
              <div class="space-y-2">
                <label class="block text-xs font-bold text-slate-500 font-sans">Credential URL</label>
                <div class="relative">
                  <i class="pi pi-link absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                  <input pInputText [(ngModel)]="item.credentialUrl" placeholder="https://..."
                    class="w-full !h-11 !pl-10 !rounded-lg !bg-slate-50 dark:!bg-slate-900 !border-slate-300 dark:!border-slate-700 !text-sm font-mono text-blue-600 focus:!border-blue-500 focus:!ring-1 focus:!ring-blue-500" />
                </div>
              </div>

              <div
                class="p-5 rounded-xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/30 flex flex-col items-center justify-center text-center gap-3 hover:border-blue-400 transition-colors">
                <div
                  class="w-10 h-10 rounded-full bg-red-50 dark:bg-red-900/20 text-red-500 flex items-center justify-center">
                  <i class="pi pi-file-pdf text-lg"></i>
                </div>
                <div>
                  <p class="text-sm font-semibold text-slate-700 dark:text-slate-300">نسخة الشهادة</p>
                  <p class="text-xs text-slate-500 mt-1">{{ item.file ? item.file.name : 'لم يتم الرفع بعد' }}</p>
                </div>
                <p-fileUpload mode="basic" [auto]="true" chooseLabel="رفع الملف"
                  styleClass="p-button-sm p-button-outlined !rounded-lg !text-xs !h-9 !px-4"
                  (onSelect)="onCertFileSelect($event, item)"></p-fileUpload>
              </div>
            </div>
          </div>
        </ng-template>
      </app-dynamic-array-list>
    </section>
  </div>
</div>