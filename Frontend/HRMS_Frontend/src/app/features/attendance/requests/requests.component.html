<div class="card bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-slate-100 dark:border-zinc-800 p-6">
    <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-6">الطلبات والإجراءات</h2>
    <p-toast></p-toast>

    <p-tabs value="0">
        <p-tablist>
            <p-tab value="0">تبديل مناوبة</p-tab>
            <p-tab value="1">عمل إضافي</p-tab>
            <p-tab value="2">سماحية / إذن</p-tab>
            <p-tab value="3">تصحيح بصمة</p-tab>
        </p-tablist>
        
        <p-tabpanels>
            <!-- Swap Request Tab -->
            <p-tabpanel value="0">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 pt-4">
                    <form [formGroup]="swapForm" (ngSubmit)="submitSwap()" class="space-y-4">
                        <div class="field">
                            <label class="block text-sm font-medium mb-1 dark:text-gray-300">تاريخ المناوبة</label>
                            <p-datepicker formControlName="rosterDate" [showIcon]="true" styleClass="w-full" inputStyleClass="w-full"></p-datepicker>
                        </div>
                        <div class="field">
                            <label class="block text-sm font-medium mb-1 dark:text-gray-300">الموظف البديل (ID)</label>
                            <p-inputNumber formControlName="targetEmployeeId" styleClass="w-full" inputStyleClass="w-full"></p-inputNumber>
                            <small class="text-gray-500">أدخل رقم الموظف الذي تريد التبديل معه</small>
                        </div>
                        <div class="field">
                            <label class="block text-sm font-medium mb-1 dark:text-gray-300">السبب</label>
                            <textarea pTextarea formControlName="reason" rows="3" class="w-full"></textarea>
                        </div>
                        <div class="pt-4">
                            <button pButton type="submit" label="إرسال الطلب" icon="pi pi-send" [disabled]="swapForm.invalid" class="p-button-primary w-full md:w-auto"></button>
                        </div>
                    </form>
                    <div class="bg-blue-50 dark:bg-blue-900/10 rounded-lg p-6">
                        <h3 class="font-bold text-blue-800 dark:text-blue-300 mb-2">تعليمات التبديل</h3>
                        <ul class="list-disc list-inside text-sm text-blue-700 dark:text-blue-400 space-y-2">
                            <li>يجب اختيار موظف لديه نفس المسمى الوظيفي.</li>
                            <li>لا يمكن التبديل في تواريخ سابقة.</li>
                            <li>يتطلب الطلب موافقة المدير والموظف البديل.</li>
                        </ul>
                    </div>
                </div>
            </p-tabpanel>

            <!-- Overtime Request Tab -->
            <p-tabpanel value="1">
                <form [formGroup]="overtimeForm" (ngSubmit)="submitOvertime()" class="max-w-xl space-y-4 pt-4">
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">التاريخ</label>
                        <p-datepicker formControlName="workDate" [showIcon]="true" styleClass="w-full"></p-datepicker>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">عـدد الساعات</label>
                        <p-inputNumber formControlName="hoursRequested" [min]="1" [max]="12" suffix=" ساعة" styleClass="w-full"></p-inputNumber>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">مبرر العمل الإضافي</label>
                        <textarea pTextarea formControlName="reason" rows="3" class="w-full"></textarea>
                    </div>
                    <button pButton type="submit" label="طلب إضافي" icon="pi pi-plus-circle" [disabled]="overtimeForm.invalid"></button>
                </form>
            </p-tabpanel>

            <!-- Permission Request Tab -->
            <p-tabpanel value="2">
                 <form [formGroup]="permissionForm" (ngSubmit)="submitPermission()" class="max-w-xl space-y-4 pt-4">
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">تاريخ الإذن</label>
                        <p-datepicker formControlName="permissionDate" [showIcon]="true" [showTime]="true" styleClass="w-full"></p-datepicker>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">نوع الإذن</label>
                        <p-select [options]="permissionTypes" formControlName="permissionType" optionLabel="label" optionValue="value" styleClass="w-full"></p-select>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">المدة (ساعات)</label>
                        <p-inputNumber formControlName="hours" [min]="0.5" [step]="0.5" suffix=" ساعة" styleClass="w-full"></p-inputNumber>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">السبب</label>
                        <textarea pTextarea formControlName="reason" rows="3" class="w-full"></textarea>
                    </div>
                    <button pButton type="submit" label="إرسال طلب إذن" icon="pi pi-clock" [disabled]="permissionForm.invalid" class="p-button-help"></button>
                </form>
            </p-tabpanel>

            <!-- Correction Request Tab -->
            <p-tabpanel value="3">
                 <form [formGroup]="correctionForm" (ngSubmit)="submitCorrection()" class="max-w-xl space-y-4 pt-4">
                     <div class="p-4 mb-4 bg-orange-50 text-orange-700 rounded border border-orange-200">
                         <i class="pi pi-info-circle mr-2"></i>
                         يستخدم هذا النموذج لتصحيح النسيان في تسجيل الدخول أو الخروج.
                     </div>
                     
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">تاريخ الواقعة</label>
                        <p-datepicker formControlName="attendanceDate" [showIcon]="true" styleClass="w-full"></p-datepicker>
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">نوع التصحيح</label>
                        <p-select [options]="correctionTypes" formControlName="correctionType" optionLabel="label" optionValue="value" styleClass="w-full"></p-select>
                    </div>
                     <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">الوقت الصحيح</label>
                        <input pInputText type="time" formControlName="newValue" class="w-full" />
                    </div>
                    <div class="field">
                        <label class="block text-sm font-medium mb-1 dark:text-gray-300">ملاحظات / مبرر</label>
                        <textarea pTextarea formControlName="auditNote" rows="3" class="w-full"></textarea>
                    </div>
                    <button pButton type="submit" label="إرسال للتصحيح" icon="pi pi-check-square" [disabled]="correctionForm.invalid" class="p-button-warning"></button>
                </form>
            </p-tabpanel>
        </p-tabpanels>
    </p-tabs>
</div>
